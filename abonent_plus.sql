 DROP DATABASE `abonent_plus`;
  CREATE DATABASE `abonent_plus`;
 USE `abonent_plus`;

/*****************************************************************/
/*                                   Tables                      */
/*****************************************************************/

DROP TABLE IF EXISTS `street`;
CREATE TABLE `street` (
    `streetcd` INT UNSIGNED NOT NULL COMMENT "Уникальный код улицы",
	`streetnm` VARCHAR(30) COMMENT "Название улицы, расшифровывающее код улицы",
    PRIMARY KEY (`streetcd`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Улицы';
    
DROP TABLE IF EXISTS `city`;
CREATE TABLE `city` (
    `citycd` INT UNSIGNED NOT NULL COMMENT "Уникальный код города",
	`citynm` VARCHAR(30) COMMENT "Название улицы, расшифровывающее код города",
    PRIMARY KEY (`citycd`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Города';
    
DROP TABLE IF EXISTS `country`;
CREATE TABLE `country` (
    `countrycd` INT UNSIGNED NOT NULL COMMENT "Уникальный код страна",
	`countrynm` VARCHAR(30) COMMENT "Название улицы, расшифровывающее код страна",
    PRIMARY KEY (`countrycd`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Cтрана';    
 
DROP TABLE IF EXISTS `services`;
CREATE TABLE `services` (
    `servicecd`  INT UNSIGNED NOT NULL COMMENT "Код услуги газоснабжения",
    `servicenm`  VARCHAR(30) COMMENT "Наименование услуги газоснабжения",
    PRIMARY KEY (`servicecd`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Услуги';
 
DROP TABLE IF EXISTS `disrepair`;
CREATE TABLE `disrepair` (
  `failurecd` INT UNSIGNED NOT NULL COMMENT "Код неисправности газового оборудования",
  `failurenm` VARCHAR(50) COMMENT "Наименоание неисправности газового оборудования",
  PRIMARY KEY (`failurecd`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Неисправности';
    
DROP TABLE IF EXISTS `executor`;   
CREATE TABLE `executor` (
    `executorcd`  INT UNSIGNED NOT NULL COMMENT "Уникальный код, идентифицирующий исполнителей ремонтных заявок",
    `fio`  VARCHAR(20) COMMENT "фамилия, имя и отчество исполнителя",
    PRIMARY KEY (`executorcd`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Исполнители';
    
DROP TABLE IF EXISTS `abonent`;     
CREATE TABLE `abonent` (
    `accountcd` VARCHAR(6) NOT NULL COMMENT "Номер лицевого счета абонента",
    `streetcd` INT UNSIGNED COMMENT "Код улицы, на которой проживает абонент" REFERENCES `street` 
      ON DELETE SET NULL ON UPDATE CASCADE ,
    `citycd` INT UNSIGNED COMMENT "Код города, в котором проживает абонент" REFERENCES `city` 
      ON DELETE SET NULL ON UPDATE CASCADE ,  
    `countrycd` INT UNSIGNED COMMENT "Код страны, в которой проживает абонент" REFERENCES `country` 
      ON DELETE SET NULL ON UPDATE CASCADE ,  
    `houseno` SMALLINT COMMENT "Номер дома, в котором проживает абонент",
    `flatno` SMALLINT COMMENT "Номер квартиры",
    `fio` VARCHAR(20) COMMENT "Фамилия, имя и отчество абонента",
    `phone` VARCHAR(15) COMMENT "Номер телефона",
    PRIMARY KEY (`accountcd`),
    FOREIGN KEY (`streetcd`) REFERENCES `street` (`streetcd`),
    FOREIGN KEY (`citycd`) REFERENCES `city` (`citycd`),
    FOREIGN KEY (`countrycd`) REFERENCES `country` (`countrycd`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Абоненты' ;
    
DROP TABLE IF EXISTS `nachislsumma`;    
CREATE TABLE `nachislsumma` (
    `nachislfactcd`  INT UNSIGNED NOT NULL COMMENT "Уникальный идентификатор факта начисления",
    `accountcd` VARCHAR(6) NOT NULL COMMENT "Номер лицевого счета абонента, которому было сделано начисление" REFERENCES `abonent`
      ON UPDATE CASCADE,
    `servicecd` INT UNSIGNED NOT NULL COMMENT "Код услуги газоснабжения, за которую выполнено начисление" REFERENCES `services` 
      ON UPDATE CASCADE,
    `nachislsum`     DECIMAL(15,2) COMMENT "Значение начисленной суммы",
    `nachislmonth`   VARCHAR(2) CHECK (`nachislmonth` BETWEEN 1 AND 12) COMMENT "Номер месяца, за который произведено начисление",
    `nachislyear`    YEAR COMMENT "Год, за месяц которого выполнено начисление",
	PRIMARY KEY (`nachislfactcd`),
    FOREIGN KEY (`accountcd`) REFERENCES `abonent` (`accountcd`),
    FOREIGN KEY (`servicecd`) REFERENCES `services` (`servicecd`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Начисления';
 
DROP TABLE IF EXISTS `paysumma`; 
CREATE TABLE `paysumma` (
    `payfactcd`  INT UNSIGNED NOT NULL COMMENT "Уникальный идентификатор факта оплаты абонентом по услуге газоснабжения",
    `accountcd`  VARCHAR(6) NOT NULL COMMENT "Номер лицевого счета абонента, оплатившего оказанную ему услугу газоснабжения" REFERENCES `abonent`
      ON UPDATE CASCADE ,
    `servicecd` INT UNSIGNED NOT NULL COMMENT "Код оплаченной услуги газоснабжения" REFERENCES `services`
      ON UPDATE CASCADE,
    `paysum`  DECIMAL(15,2) COMMENT "Значение оплаченной суммы",
    `paydate`  DATE COMMENT "Дата оплаты",
    `paymonth`  VARCHAR(2) CHECK (`paymonth` BETWEEN 1 AND 12) COMMENT "Номер оплачиваемого месяца",
    `payyear`  YEAR COMMENT "Оплачиваемый год",
	PRIMARY KEY (`payfactcd`),
    FOREIGN KEY (`accountcd`) REFERENCES `abonent` (`accountcd`),
    FOREIGN KEY (`servicecd`) REFERENCES `services` (`servicecd`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Оплаты';

DROP TABLE IF EXISTS `request`;    
CREATE TABLE `request` (
    `requestcd` INT UNSIGNED NOT NULL COMMENT "Уникальный код ремонтной заявки",
    `accountcd`  VARCHAR(6) COMMENT "Номер лицевого счета абонента, подавшего данную ремонтную заявку" REFERENCES `abonent`
      ON DELETE SET NULL ON UPDATE CASCADE,
    `executorcd`  INT UNSIGNED COMMENT "Код неисправности газового оборудования, заявленной абонентом в данной ремонтной заявке" REFERENCES `executor`
      ON DELETE SET NULL ON UPDATE CASCADE,
    `failurecd`  INT UNSIGNED COMMENT "Код исполнителя, ответственного за выполнение данной ремонтной заявки" REFERENCES `disrepair`
      ON DELETE SET NULL ON UPDATE CASCADE,
    `incomingdate`  DATE COMMENT "Дата поступления заявки",
    `executiondate`  DATE COMMENT "Дата выполнения заявки",
    `executed`  BOOLEAN COMMENT "Признак того, погашена заявка или нет",
	PRIMARY KEY (`requestcd`),
    FOREIGN KEY (`accountcd`) REFERENCES `abonent` (`accountcd`),
    FOREIGN KEY (`executorcd`) REFERENCES `executor` (`executorcd`),
    FOREIGN KEY (`failurecd`) REFERENCES `disrepair` (`failurecd`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8 COLLATE=utf8_unicode_ci COMMENT='Заявки';
   
   
/*****************************************************************/
/*                                 Insert  STREET                                                                   */
/*****************************************************************/
INSERT INTO STREET (STREETCD, STREETNM) VALUES (3, 'ВОЙКОВ ПЕРЕУЛОК');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (7, 'КУТУЗОВА УЛИЦА');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (6, 'МОСКОВСКАЯ УЛИЦА');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (8, 'МОСКОВСКОЕ ШОССЕ');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (4, 'ТАТАРСКАЯ УЛИЦА');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (5, 'ГАГАРИНА УЛИЦА');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (1, 'ЦИОЛКОВСКОГО УЛИЦА');
INSERT INTO STREET (STREETCD, STREETNM) VALUES (2, 'НОВАЯ УЛИЦА');
COMMIT WORK;
/*****************************************************************/
/*                                 Insert  CITY                                                                   */
/*****************************************************************/
INSERT INTO CITY (CITYCD, CITYNM) VALUES (1, 'Рязань');
INSERT INTO CITY (CITYCD, CITYNM) VALUES (2, 'Москва');
INSERT INTO CITY (CITYCD, CITYNM) VALUES (3, 'Казань');
INSERT INTO CITY (CITYCD, CITYNM) VALUES (4, 'Харьков');
INSERT INTO CITY (CITYCD, CITYNM) VALUES (5, 'Новосибирск');
INSERT INTO CITY (CITYCD, CITYNM) VALUES (6, 'Волгоград');
INSERT INTO CITY (CITYCD, CITYNM) VALUES (7, 'Иваново');
COMMIT WORK;
/*****************************************************************/
/*                                 Insert  COUNNTRY                                                                   */
/*****************************************************************/
INSERT INTO COUNTRY (COUNTRYCD, COUNTRYNM) VALUES (1, 'РОССИЯ');
INSERT INTO COUNTRY (COUNTRYCD, COUNTRYNM) VALUES (2, 'УКРАИНА');
INSERT INTO COUNTRY (COUNTRYCD, COUNTRYNM) VALUES (3, 'КАЗАХСТАН');
INSERT INTO COUNTRY (COUNTRYCD, COUNTRYNM) VALUES (4, 'БЕЛОРУССИЯ');
INSERT INTO COUNTRY (COUNTRYCD, COUNTRYNM) VALUES (5, 'МОЛДАВИЯ');
INSERT INTO COUNTRY (COUNTRYCD, COUNTRYNM) VALUES (6, 'ЛАТВИЯ');
INSERT INTO COUNTRY (COUNTRYCD, COUNTRYNM) VALUES (7, 'АРМЕНИЯ');
COMMIT WORK;
/*****************************************************************/
/*                                 Insert  SERVICES                                                               */
/*****************************************************************/
INSERT INTO SERVICES (SERVICECD, SERVICENM) VALUES (1, 'Газоснабжение');
INSERT INTO SERVICES (SERVICECD, SERVICENM) VALUES (2, 'Электроснабжение');
INSERT INTO SERVICES (SERVICECD, SERVICENM) VALUES (3, 'Теплоснабжение');
INSERT INTO SERVICES (SERVICECD, SERVICENM) VALUES (4, 'Водоснабжение');
COMMIT WORK;
/*****************************************************************/
/*                                 Insert  DISREPAIR                                                             */
/*****************************************************************/
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (1, 'Засорилась водогрейная колонка');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (2, 'Не горит АГВ');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (3, 'Течет из водогрейной колонки');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (4, 'Неисправна печная горелка');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (5, 'Неисправен газовый счетчик');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (6, 'Плохое поступление газа на горелку плиты');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (7, 'Туго поворачивается пробка крана плиты');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (8, 'При закрытии краника горелка плиты не гаснет');
INSERT INTO DISREPAIR (FAILURECD, FAILURENM) VALUES (12, 'Неизвестна');
COMMIT WORK;
/*****************************************************************/
/*                                 Insert  EXECUTOR                                                            */
/*****************************************************************/
INSERT INTO EXECUTOR (EXECUTORCD, FIO) VALUES (1, 'Стародубцев Е.М.');
INSERT INTO EXECUTOR (EXECUTORCD, FIO) VALUES (2, 'Булгаков Т.И.');
INSERT INTO EXECUTOR (EXECUTORCD, FIO) VALUES (3, 'Шубин В.Г.');
INSERT INTO EXECUTOR (EXECUTORCD, FIO) VALUES (4, 'Шлюков М.К.');
INSERT INTO EXECUTOR (EXECUTORCD, FIO) VALUES (5, 'Школьников С.М.');
COMMIT WORK;
/*****************************************************************/
/*                                 Insert  ABONENT                                                              */
/*****************************************************************/
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('005488', 3, 1, 1, 4, 1, 'Аксенов С.А.', '556893');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('115705', 3, 1, 1, 1, 82, 'Мищенко Е.В.', '769975');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('015527', 3, 1, 1, 1, 65, 'Конюхов В.С.', '761699');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('443690', 7, 1, 1, 5, 1, 'Тулупова М.И.', '214833');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('136159', 7, 1, 1, 39, 1, 'Свирина З.А.', NULL);
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('443069', 4, 1, 1, 51, 55, 'Стародубцев Е.В.', '683014');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('136160', 4, 1, 1, 9, 15, 'Шмаков С.В.', NULL);
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('126112', 4, 1, 1, 7, 11, 'Маркова В.П.', '683301');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('136169', 4, 1, 1, 7, 13, 'Денисова Е.К.', '680305');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('080613', 8, 1, 1, 35, 11, 'Лукашина Р.М.', '254417');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('080047', 8, 1, 1, 39, 36, 'Шубина Т.П.', '257842');
INSERT INTO ABONENT (ACCOUNTCD, STREETCD, CITYCD, COUNTRYCD, HOUSENO, FLATNO, FIO, PHONE) VALUES ('080270', 6, 1, 1, 35, 6, 'Тимошкина Н.Г.', '321002');
COMMIT WORK;
/*****************************************************************/
/*                                 Insert  NACHISLSUMMA                                                 */
/*****************************************************************/
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (19, '005488', 2, 58.7, 12, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (2, '005488', 2, 46, 12, 2006);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (3, '005488', 2, 56, 4, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (4, '115705', 2, 40, 1, 2006);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (5, '115705', 2, 250, 9, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (13, '136160', 2, 20, 5, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (1, '136160', 2, 56, 1, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (15, '136169', 2, 20, 5, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (7, '080047', 2, 80, 10, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (8, '080047', 2, 80, 10, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (9, '080270', 2, 46, 12, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (10, '080613', 2, 56, 6, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (11, '115705', 2, 250, 9, 2006);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (12, '115705', 2, 58.7, 8, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (16, '136169', 2, 58.7, 11, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (17, '443069', 2, 80, 9, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (18, '443069', 2, 38.5, 8, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (6, '136160', 1, 18.3, 1, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (20, '015527', 1, 28.32, 7, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (21, '080047', 1, 19.56, 3, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (22, '080613', 1, 10.6, 9, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (23, '443069', 1, 38.28, 12, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (24, '015527', 1, 38.32, 4, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (25, '115705', 1, 37.15, 10, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (26, '080613', 1, 12.6, 8, 2006);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (27, '136169', 1, 25.32, 1, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (28, '080270', 1, 57.1, 2, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (29, '136159', 1, 8.3, 8, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (30, '005488', 1, 62.13, 4, 2006);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (31, '115705', 1, 37.8, 5, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (32, '443690', 1, 17.8, 6, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (33, '080047', 1, 22.56, 5, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (34, '126112', 1, 15.3, 8, 2006);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (35, '080047', 1, 32.56, 9, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (36, '080613', 1, 12.6, 4, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (37, '115705', 1, 37.15, 11, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (38, '080270', 1, 58.1, 12, 2006);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (39, '136169', 1, 28.32, 1, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (40, '015527', 1, 18.32, 2, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (41, '443690', 1, 21.67, 3, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (42, '080613', 1, 22.86, 4, 2006);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (43, '080270', 1, 60.1, 5, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (44, '136169', 1, 28.32, 2, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (45, '080047', 1, 22.2, 7, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (46, '126112', 1, 25.3, 8, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (47, '443069', 1, 38.32, 9, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (48, '136159', 1, 8.3, 10, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (49, '115705', 1, 37.15, 6, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (50, '136160', 1, 18.3, 12, 2006);

INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (51, '005488', 3, 279.8, 5, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (52, '005488', 3, 266.7, 2, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (53, '015527', 3, 343.36, 11, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (54, '080047', 3, 271.6, 2, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (55, '080270', 3, 278.25, 11, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (56, '080613', 3, 254.4, 7, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (57, '080613', 3, 258.8, 2, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (58, '080613', 3, 239.33, 5, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (59, '126112', 3, 179.9, 4, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (60, '136159', 3, 180.13, 9, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (61, '136160', 3, 238.8, 3, 2006);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (62, '136160', 3, 237.38, 3, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (63, '136169', 3, 349.19, 6, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (64, '136169', 3, 346.18, 7, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (65, '443690', 3, 290.33, 3, 2009);

INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (66, '015527', 4, 580.1, 7, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (67, '015527', 4, 611.3, 10, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (68, '080270', 4, 444.34, 3, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (69, '080270', 4, 453.43, 6, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (70, '080270', 4, 454.6, 4, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (71, '115705', 4, 553.85, 1, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (72, '126112', 4, 435.5, 6, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (73, '136159', 4, 349.38, 4, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (74, '136159', 4, 418.88, 6, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (75, '136169', 4, 528.44, 10, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (76, '443069', 4, 466.69, 5, 2008);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (77, '443069', 4, 444.45, 10, 2009);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (78, '443690', 4, 480.88, 8, 2007);
INSERT INTO NACHISLSUMMA (NACHISLFACTCD, ACCOUNTCD, SERVICECD, NACHISLSUM, NACHISLMONTH, NACHISLYEAR) VALUES (79, '443690', 4, 500.13, 9, 2008);

COMMIT WORK;
/*****************************************************************/
/*                                 Insert  PAYSUMMA                                                          */
/*****************************************************************/
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (1, '005488', 2, 58.7, '2008-01-08', 12, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (2, '005488', 2, 40, '2007-01-06', 12, 2006);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (3, '005488', 2, 56, '2009-05-06', 4, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (4, '115705', 2, 40, '2006-02-10', 1, 2006);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (5, '115705', 2, 250, '2007-10-03', 9, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (6, '136160', 2, 20, '2007-06-13', 5, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (7, '136160', 2, 56, '2009-02-12', 1, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (8, '136169', 2, 20, '2007-06-22', 5, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (9, '080047', 2, 80, '2008-11-26', 10, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (10, '080047', 2, 80, '2007-11-21', 10, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (11, '080270', 2, 30, '2008-01-03', 12, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (12, '080613', 2, 58.5, '2007-07-19', 6, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (13, '115705', 2, 250, '2006-10-06', 9, 2006);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (14, '115705', 2, 58.7, '2007-09-04', 8, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (15, '136169', 2, 58.7, '2007-12-01', 11, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (16, '443069', 2, 80, '2007-10-03', 9, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (17, '443069', 2, 38.5, '2007-09-13', 8, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (18, '136160', 1, 18, '2008-02-05', 1, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (19, '015527', 1, 30, '2008-08-03', 7, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (20, '080047', 1, 19.56, '2008-04-02', 3, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (21, '080613', 1, 11, '2008-10-03', 9, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (22, '443069', 1, 38.28, '2009-02-04', 12, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (23, '015527', 1, 40, '2009-05-07', 4, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (24, '115705', 1, 37.15, '2009-11-04', 10, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (25, '080613', 1, 12, '2006-09-20', 8, 2006);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (26, '136169', 1, 25.32, '2009-02-03', 1, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (27, '080270', 1, 60, '2008-03-05', 2, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (28, '136159', 1, 8.3, '2009-09-10', 8, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (29, '005488', 1, 65, '2006-05-03', 4, 2006);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (30, '115705', 1, 37.8, '2007-07-12', 5, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (31, '443690', 1, 20, '2008-07-10', 6, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (32, '080047', 1, 22.56, '2009-06-25', 5, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (33, '126112', 1, 15.3, '2006-09-08', 8, 2006);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (34, '080047', 1, 32.56, '2007-10-18', 9, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (35, '080613', 1, 12.6, '2008-05-22', 4, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (36, '115705', 1, 37.15, '2009-12-23', 11, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (37, '080270', 1, 58.1, '2007-01-07', 12, 2006);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (38, '136169', 1, 28.32, '2007-02-08', 1, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (39, '015527', 1, 20, '2008-03-18', 2, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (40, '443690', 1, 19.47, '2009-04-10', 3, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (41, '080613', 1, 22.86, '2006-05-04', 4, 2006);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (42, '080270', 1, 60, '2007-06-07', 5, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (43, '136169', 1, 28.32, '2008-03-05', 2, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (44, '080047', 1, 22.2, '2009-08-10', 7, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (45, '126112', 1, 25.3, '2007-09-10', 8, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (46, '443069', 1, 38.32, '2007-10-09', 9, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (47, '136159', 1, 8.3, '2008-11-14', 10, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (48, '115705', 1, 37.15, '2009-08-10', 6, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (49, '136160', 1, 16, '2007-01-07', 12, 2006);

INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (50, '005488', 3, 280, '2008-06-10', 5, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (51, '005488', 3, 260, '2009-03-11', 2, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (52, '015527', 3, 345, '2009-12-15', 11, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (53, '080047', 3, 271.6, '2009-03-12', 2, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (54, '080270', 3, 278, '2009-12-06', 11, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (55, '080613', 3, 254.4, '2007-08-10', 7, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (56, '080613', 3, 258.8, '2009-03-8', 2, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (57, '080613', 3, 239.35, '2009-06-11', 5, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (58, '126112', 3, 179.9, '2008-05-01', 4, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (59, '136159', 3, 180.13, '2009-10-21', 9, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (60, '136160', 3, 240, '2006-04-04', 3, 2006);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (61, '136160', 3, 200, '2007-04-06', 3, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (62, '136169', 3, 349.19, '2008-07-14', 6, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (63, '136169', 3, 346.18, '2008-08-13', 7, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (64, '443690', 3, 295, '2009-04-09', 3, 2009);

INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (65, '015527', 4, 580.1, '2008-08-08', 7, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (66, '015527', 4, 611.3, '2009-11-03', 10, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (67, '080270', 4, 444.5, '2007-04-18', 3, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (68, '080270', 4, 450, '2008-07-14', 6, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (69, '080270', 4, 460, '2009-05-12', 4, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (70, '115705', 4, 553.85, '2008-02-02', 1, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (71, '126112', 4, 435.5, '2008-07-12', 6, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (72, '136159', 4, 349.38, '2007-05-18', 4, 2007);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (73, '136159', 4, 420, '2008-07-09', 6, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (74, '136169', 4, 528.44, '2009-11-26', 10, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (75, '443069', 4, 466.69, '2008-06-03', 5, 2008);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (76, '443069', 4, 444.45, '2009-11-16', 10, 2009);
INSERT INTO PAYSUMMA (PAYFACTCD, ACCOUNTCD, SERVICECD, PAYSUM, PAYDATE, PAYMONTH, PAYYEAR) VALUES (77, '443690', 4, 485, '2007-09-05', 8, 2007);

COMMIT WORK;
/*****************************************************************/
/*                                 Insert  REQUEST                                                               */
/*****************************************************************/
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (1, '005488', 1, 1, '2007-12-17', '2007-12-20', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (2, '115705', 3, 1, '2007-08-07', '2007-08-12', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (3, '015527', 1, 12, '2008-02-28', '2008-03-08', 0);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (5, '080270', 4, 1, '2007-12-31', NULL, 0);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (6, '080613', 1, 6, '2007-06-16', '2007-06-24', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (7, '080047', 3, 2, '2008-10-20', '2008-10-24', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (9, '136169', 2, 1, '2007-11-06', '2007-11-08', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (10, '136159', 3, 12, '2007-04-01', '2007-04-03', 0);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (11, '136160', 1, 6, '2009-01-12', '2009-01-12', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (12, '443069', 5, 2, '2007-08-08', '2007-08-10', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (13, '005488', 5, 8, '2006-09-04', '2006-12-05', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (14, '005488', 4, 6, '2009-04-04', '2009-04-13', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (15, '115705', 4, 5, '2006-09-20', '2006-09-23', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (16, '115705', NULL, 3, '2007-12-28', NULL, 0);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (17, '115705', 1, 5, '2007-08-15', '2007-09-06', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (18, '115705', 2, 3, '2008-12-28', '2009-01-04', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (19, '080270', 4, 8, '2007-12-17', '2007-12-27', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (20, '080047', 3, 2, '2007-10-11', '2007-10-11', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (21, '443069', 1, 2, '2007-09-13', '2007-09-14', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (22, '136160', 1, 7, '2007-05-18', '2007-05-25', 1);
INSERT INTO REQUEST (REQUESTCD, ACCOUNTCD, EXECUTORCD, FAILURECD, INCOMINGDATE, EXECUTIONDATE, EXECUTED) VALUES (23, '136169', 5, 7, '2007-05-07', '2007-05-08', 1);
COMMIT WORK;


/*****************************************************************/
/*                                  Querys                       */
/*****************************************************************/

-- Найдем все пары абонентов, проживающих на одной и той же улице.
SELECT F.Fio, S.Fio
FROM Abonent F, Abonent S
WHERE F.StreetCD = S.StreetCD AND F.Fio < S.Fio;

SELECT F.Fio, S.Fio
FROM Abonent F 
JOIN Abonent S ON F.StreetCD = S.StreetCD
WHERE F.Fio < S.Fio;

-- Вывести информацию о датах выполнения ремонтных заявок, поступивших от абонентов с номерами лицевых счетов '005488',
-- '115705' и '080270'. Если дата выполнения неизвестна, вывести дату
-- поступления заявки. Если ни дата поступления, ни дата выполнения не
-- известны, то вывести 'Дата неизвестна'.
SELECT RequestCD,
COALESCE(ExecutionDate, IncomingDate, 'Дата не известна') AS Date_Info
FROM Request
WHERE AccountCD IN ('005488', '115705', '080270');

/*****************************************************************/
/*                                  View                         */
/*****************************************************************/

-- Представление date_abonent показывает ФИО абонентов и дату подачи ими ремонтных заявок
CREATE VIEW date_abonent (abonent_name, data) 
AS SELECT fio,
          IncomingDate 
     FROM abonent,
          request
     WHERE abonent.accountcd = request.accountcd;

SELECT * 
FROM date_abonent;

-- Представление max_pay показывает ФИО 5 максимальных значений оплат
CREATE VIEW max_pay (accountcd, big_sum, paydate) 
AS SELECT accountcd, paysum, paydate
     FROM paysumma
     ORDER BY paysum DESC 
     LIMIT 5;
     
SELECT * FROM max_pay;

/*****************************************************************/
/*                                  Triggers                                                                              */
/*****************************************************************/
-- Триггер td_executor при удалении строки из табоицы executor удаляет все связанные с ним строки из таблицы request, потом
-- из саму строку из таблицы exequtor, для обеспечения целостности данных.

DROP TRIGGER IF EXISTS td_executor;
DELIMITER //
 CREATE TRIGGER td_executor AFTER DELETE ON executor 
 FOR EACH ROW
 BEGIN
   DELETE FROM request WHERE executorcd = old.executorcd;
   DELETE FROM executor WHERE executorcd = old.executorcd;
end;//
 
 --  Триггер str_delete до удаления строки в таблице street находит количество строк с ключом streetcd если строки есть, то иницируется исключение.
 
DROP TRIGGER IF EXISTS str_delete; 
 DELIMITER //
CREATE TRIGGER str_delete BEFORE DELETE ON street
FOR EACH ROW
BEGIN
  SELECT COUNT(*) INTO @numrows FROM abonent
  WHERE abonent.streetcd = oldstreetcd;
  IF (@numrows > 0) THEN
    SIGNAL SQLSTATE '45000'
    SET MESSAGE_TEXT = 'Ограничение удаления записи из родительской таблицы';
  END IF;
END;//

--  Триггер str_update до обновления строки в таблице street находит количество строк с ключом streetcd если строки есть, то иницируется исключение.
DROP TRIGGER IF EXISTS str_update; 
DELIMITER //
CREATE TRIGGER str_update BEFORE UPDATE ON street
FOR EACH ROW
BEGIN
  SELECT COUNT(*) INTO @numrows FROM abonent
  WHERE abonent.streetcd = oldstreetcd;
  IF (@numrows > 0) THEN
     SIGNAL SQLSTATE '45000'
     SET MESSAGE_TEXT = 'Ограничение модификации записи в родительской таблице';
  END IF;
END;//
